<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Description of tools" href="tools.html" /><link rel="prev" title="Handling of meta-information" href="meta.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>About operators and tags - fieldextra v13_0_0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">fieldextra v13_0_0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">fieldextra v13_0_0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Program usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="products.html">Supported products and data representations</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="control/intro.html">Control file</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="control/runSpec.html"><code class="xref nl nl-nl docutils literal notranslate"><span class="pre">&amp;RunSpecification</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="control/globRes.html"><code class="xref nl nl-nl docutils literal notranslate"><span class="pre">&amp;GlobalResource</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="control/globSet.html"><code class="xref nl nl-nl docutils literal notranslate"><span class="pre">&amp;GlobalSettings</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="control/netcdf.html"><code class="xref nl nl-nl docutils literal notranslate"><span class="pre">&amp;NetCDFImport</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="control/inspectSpec.html"><code class="xref nl nl-nl docutils literal notranslate"><span class="pre">&amp;InspectSpecification</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="control/modelSpec.html"><code class="xref nl nl-nl docutils literal notranslate"><span class="pre">&amp;ModelSpecification</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="control/process.html"><code class="xref nl nl-nl docutils literal notranslate"><span class="pre">&amp;Process</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="operators.html">Operators to compute new fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Description of support files</a></li>
<li class="toctree-l1"><a class="reference internal" href="output.html">Description of output format</a></li>
<li class="toctree-l1"><a class="reference internal" href="grib1.html">Description of some GRIB1 conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="grib2.html">Description of GRIB2 local use</a></li>
<li class="toctree-l1"><a class="reference internal" href="meta.html">Handling of meta-information</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">About operators and tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Description of tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="lexicon.html">Lexicon</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary of namelist objects and their usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html"><code class="xref nl nl-nl docutils literal notranslate"><span class="pre">&amp;Test</span></code></a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="about-operators-and-tags">
<h1>About operators and tags<a class="headerlink" href="#about-operators-and-tags" title="Permalink to this heading">#</a></h1>
<p>When using multiple operators and working with tags, the following rules have to be kept
in mind:</p>
<blockquote>
<div><ul class="simple">
<li><p>The fields you define for tmp1_field, … out_field, are either taken from the previous
iteration, or computed using parents fields found in the previous iteration;</p></li>
<li><p>All operators you define within an iteration, like poper, poper2 … modify the
values of the field you have at the start of the iteration;</p></li>
<li><p>Operators are applied in turns, as in a pipeline, the output of the previous operator
being used as input for the next operator, in the order hoper, scale/offset, voper,
toper, poper, poper2, poper3, poper4, poper5, spatial filter, new_field_id;</p></li>
<li><p>When you have multiple fields in the same iteration, each class of operator is applied
to all the concerned fields before stepping to the next class of operators;</p></li>
<li><p>The tags you specify are attached to the field at the start of the iteration;</p></li>
<li><p>The tags or the short names you refer to in some operator refer to fields in the same
iteration, in the state the field has just before applying the concerned operator (!);</p></li>
<li><p>Finally, the order of appeareance in the namelist of the fields or of the operators
do not influence the results.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>To illustrate these rules, consider the following namelist snippet :</dt><dd><dl class="simple">
<dt>&amp;Process tmp2_field=’TOT_PREC’, tag=’CBHEXT1’,</dt><dd><p>poper=’polynomial,0.16,0.4545’,
poper2=’replace_cond,TOT_PREC&lt;0.2 || TOT_PREC&gt;0.75,0.0’ /</p>
</dd>
</dl>
</dd>
</dl>
<p>The field TOT_PREC is taken from the previous iteration, associated with the tag CBHEXT1,
modified by poper, then by poper2.
The first operator _replaces_ TOT_PREC with (0.16 + 0.4545*TOT_PREC).
The second operator _replaces_ the just computed value, (0.16 + 0.4545*TOT_PREC),
with 0.0 where the condition is true.
The condition is based on TOT_PREC, and  fieldextra recognizes that TOT_PREC is the
field being currently processed; according to the rules just explained, the values of
the field _at this <a href="#id1"><span class="problematic" id="id2">stage_</span></a> of the computation are taken to evaluate the condition, i.e.
after applying the polynomial transformation!
In other words, in this first example, TOT_PREC is replaced by:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>if (0.16 + 0.4545*TOT_PREC) &lt; 0.2,  i.e. TOT_PREC &lt; 0.088</p></li>
</ol>
<p>2.                         if (0.16 + 0.4545*TOT_PREC) &gt; 0.75, i.e. TOT_PREC &gt; 1.298
(0.16 + 0.4545*TOT_PREC)   otherwise.</p>
</div></blockquote>
<dl>
<dt>Compare this with the following namelist snippet :</dt><dd><p>&amp;Process tmp2_field=’TOT_PREC’, tag=’tot_prec’,
&amp;Process tmp2_field=’TOT_PREC’, tag=’cbhext1’,</p>
<blockquote>
<div><p>poper=’polynomial,0.16,0.4545’,
poper2=’replace_cond,tot_prec&lt;0.2 || tot_prec&gt;0.75,0.0’ /</p>
</div></blockquote>
</dd>
<dt>In this second example, TOT_PREC is replaced by:</dt><dd><ol class="arabic simple">
<li><p>if TOT_PREC &lt; 0.2</p></li>
</ol>
<p>2.                         if TOT_PREC &gt; 0.75
(0.16 + 0.4545*TOT_PREC)   otherwise.</p>
</dd>
</dl>
<p>Some remarks about the previous namelist snippet:
*       a second field is introduced in the tmp2_field iteration to hold the unmodified</p>
<blockquote>
<div><p>TOT_PREC;</p>
</div></blockquote>
<ul class="simple">
<li><p>a tag is associated with the unmodified TOT_PREC, for usage in the conditions</p></li>
</ul>
<blockquote>
<div><p>of poper2;</p>
</div></blockquote>
<ul class="simple">
<li><p>the operator || is used in the logical condition to make the namelist more</p></li>
</ul>
<blockquote>
<div><p>compact (and more efficient);</p>
</div></blockquote>
<ul class="simple">
<li><p>It is recommended to use short names for user defined field tags, to clearly</p></li>
</ul>
<blockquote>
<div><p>distinguish between field tags and field short names.</p>
</div></blockquote>
<p>These examples illustrate the fact that the syntax of the namelist is very close
to the internal working of the code; consequently, it is important to have a
good understanding of the internal working of fieldextra when crafting new
namelists.</p>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="tools.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Description of tools</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="meta.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Handling of meta-information</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Jean-Marie Bettems, Tierry Hörmann
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>